<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öîÔ∏è</text></svg>" />
    <title>Hello World - Lifecycle Orchestration</title>
    <script type="importmap">
      {
        "imports": {
          "cede": "../index.js"
        }
      }
    </script>
    <style>
      html {
        color-scheme: light dark;
        font-family: system-ui, sans-serif;
      }

      body {
        max-width: 800px;
        margin: 2rem auto;
        padding: 0 1rem;
      }

      h1 {
        color: #0066ff;
        margin-bottom: 2rem;
      }

      #directoryListing {
        display: grid;
        gap: 1rem;
      }

      .hello-item {
        padding: 1rem;
        background: #f0f0f0;
        border-radius: 8px;
        border-left: 4px solid #0066ff;
      }

      .hello-text {
        font-size: 1.25rem;
        font-weight: 500;
        margin: 0;
      }

      @media (prefers-color-scheme: dark) {
        .hello-item {
          background: #2c2b32;
          border-left-color: #4d9fff;
        }
      }
    </style>
    <style>
    /* https://github.com/animate-css/animate.css/blob/main/source/bouncing_entrances/bounceIn.css */
    @keyframes changeNotify {
      from, 20%, 40%, 60%, 80%, to { animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }

      0% {
        opacity: 0;
        transform: scale3d(0.3, 0.3, 0.3);
      }

      20% {
        transform: scale3d(1.1, 1.1, 1.1);
      }

      40% {
        transform: scale3d(0.9, 0.9, 0.9);
      }

      60% {
        opacity: 1;
        transform: scale3d(1.03, 1.03, 1.03);
      }

      80% {
        transform: scale3d(0.97, 0.97, 0.97);
      }

      to {
        opacity: 1;
        transform: scale3d(1, 1, 1);
      }
    }
    </style>
  </head>

  <body id="apps">
    <h1>üåç Hello World in 10 Languages</h1>

    <div id="helloWorldApp">
      <div id="directoryListing"></div>
    </div>

    <!-- Templates -->
    <template id="helloWorldTemplate">
      <!-- Container for repeater -->
    </template>

    <template id="repeaterTemplate">
      <div class="hello-item">
        <p class="hello-text" data-name="hello">Hello World</p>
      </div>
    </template>

    <!-- XML App Declaration -->
    <xml-app id="helloApp" src="hello-app.xml"></xml-app>

    <script type="module">
      // Import your lifecycle classes and XmlApp
      import { XmlApp, ApplicationLifecycle, TemplateLifecycle, RepeaterLifecycle, TreeLifecycle } from 'cede';

      // Register lifecycle components
      XmlApp.registerLifecycle('Application', ApplicationLifecycle);
      XmlApp.registerLifecycle('Template', TemplateLifecycle);
      XmlApp.registerLifecycle('Repeater', RepeaterLifecycle);
      XmlApp.registerLifecycle('Tree', TreeLifecycle);

      // Wait for the XML app to load and initialize
      const helloAppElement = document.getElementById('helloApp');
      await helloAppElement.state.complete;

      // helloAppElement.root.tree.write("/helloApp/hello.arr/0/hello", 'üëã Hello Universe!');

      const greatings = [
        { hello: 'Hello World' },        // English
        { hello: 'Hola Mundo' },         // Spanish
        { hello: 'Bonjour le Monde' },   // French
        { hello: 'Hallo Welt' },         // German
        { hello: 'Ciao Mondo' },         // Italian
        { hello: 'Witam ≈öwiat' },        // Polish
        { hello: '„Åì„Çì„Å´„Å°„ÅØ‰∏ñÁïå' },       // Japanese
        { hello: '‰Ω†Â•Ω‰∏ñÁïå' },            // Chinese
        { hello: '–ü—Ä–∏–≤–µ—Ç –º–∏—Ä' },        // Russian
      ];

      helloAppElement.root.tree.write("/helloApp/hello.arr", greatings);


      // // Demonstrate reactivity after 2 seconds
      setTimeout(() => {
        console.log('‚ú® Updating first greeting...');
        // helloAppElement.root.tree.write("/helloApp/hello.arr/0", { hello: 'üëã Hello Universe!' });
        helloAppElement.root.tree.write("/helloApp/hello.arr/0/hello", 'üëã Hello Universe!');
      }, 2000);



      setInterval(()=>{
        helloAppElement.root.tree.read("/helloApp/hello.arr")
        const a = helloAppElement.root.tree.read("/helloApp/hello.arr");
        const i = Math.floor(Math.random() * a.length);
        const j = Math.floor(Math.random() * a.length);
        helloAppElement.root.tree.write(`/helloApp/hello.arr/${i}/hello`, greatings[j].hello);
      }, 1_000);

    </script>
  </body>
</html>
